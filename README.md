# AI 학습을 위한 이미지 전처리 파이프라인

이 프로젝트는 AI 모델 학습에 사용될 이미지 데이터셋을 준비하는 전처리 과정입니다.
`image_preprocessing.py` 스크립트는 원본 이미지를 입력받아, 부적합한 데이터를 걸러내고(filtering), AI 학습에 적합한 형태로 변환(preprocessing)하며, 데이터의 양을 늘리는(augmentation) 작업을 수행합니다.



### 1. 기본 전처리 (기본 문제)

필터링을 통과한 이미지는 AI 모델의 입력 형식에 맞게 표준화됩니다.

-   **크기 조절**: 모든 이미지를 `224x224` 픽셀의 동일한 크기로 통일합니다. 이는 모델 입력 크기를 고정하기 위함입니다.
-   **색상 변환**: 컬러 이미지를 **Grayscale(흑백)** 이미지로 변환하여, 색상 정보를 제거하고 형태 정보에 집중하도록 합니다. 이는 연산량을 줄이는 효과도 있습니다.
-   **노이즈 제거**: **가우시안 블러(Gaussian Blur)** 필터를 적용하여 이미지의 미세한 노이즈를 부드럽게 처리합니다.
-   **정규화(Normalization)**: 픽셀 값을 0~255 범위에서 0.0~1.0 범위로 변환합니다. 이는 모델 학습을 안정화하고 수렴 속도를 높이는 데 도움을 줍니다.
-   **데이터 증강**: 좌우 반전(Flip), 회전(Rotate), 색상 변화

###  2. 이상치 탐지 및 필터링 (심화 문제)

학습 데이터의 품질을 높이기 위해 부적합한 이미지를 사전에 제거합니다.

-   **너무 어두운 이미지 제거**: 이미지 전체 픽셀의 평균 밝기를 계산하여, 설정된 임계값(`BRIGHTNESS_THRESHOLD`)보다 낮으면 학습 데이터에서 제외합니다. 이는 조명이 부족하여 객체 식별이 어려운 이미지를 걸러냅니다.
-   **객체가 너무 작은 이미지 제거**: 이미지에서 가장 면적이 넓은 객체(Contour)를 찾고, 이 객체가 전체 이미지에서 차지하는 비율을 계산합니다. 이 비율이 설정된 임계값(`OBJECT_SIZE_THRESHOLD`)보다 작으면 객체가 너무 작다고 판단하여 제외합니다.

### 3. 데이터 증강 (Data Augmentation)

하나의 원본 이미지로부터 여러 개의 변형된 이미지를 생성하여 학습 데이터의 양과 다양성을 확보합니다. 이는 모델의 일반화 성능을 높여 새로운 데이터에 대해서도 강건하게 만듭니다.

-   **좌우 반전(Flip)**: 이미지를 수평으로 뒤집습니다.
-   **회전(Rotate)**: 이미지를 특정 각도(예: 15도)로 회전시킵니다.
-   **색상 변화(Color Jitter)**: Grayscale 이미지이므로, 픽셀 전체에 일정한 값을 더해 **밝기를 조절**하는 방식으로 증강을 수행합니다.

## 실행 방법

1.  `D:\my_cv_project\original_images` 폴더에 원본 이미지들을 다운로드 >>100개의 사진 저장
2.  터미널 또는 IDE에서 `image_preprocessing.py` 스크립트를 실행
3.  `D:\my_cv_project\preprocessed_samples` 폴더에 전처리 및 증강이 완료된 샘플 이미지들이 저장됨!
